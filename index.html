<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ­ TasteLink | YumYum Network</title>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>

<style>
body { margin:0; font-family:'Arial', sans-serif; background: linear-gradient(to bottom, #a0e1ff, #ffffff); overflow-x:hidden; }
h1,h2,h3,h4 { text-align:center; margin:5px; }
button { cursor:pointer; transition:0.2s; }
button:hover { transform:scale(1.05); }

/* Welcome */
#welcome-screen { display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#6abfff; color:white; }
#welcome-screen button { margin-top:20px; padding:12px 24px; font-size:18px; font-weight:bold; border:none; border-radius:12px; background:#ffcc00; color:#333; }

/* Login / Avatar */
#login-screen { display:none; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#ffe0f0; }
#avatar-preview { font-size:64px; margin:10px; width:120px; height:120px; display:flex; align-items:center; justify-content:center; border-radius:50%; border:3px solid #ff6f61; }
.avatar-option { font-size:32px; margin:3px; cursor:pointer; border:2px solid #333; border-radius:12px; padding:6px; display:inline-block; }
.avatar-option:hover { border-color:#ff6f61; }

/* Park / Garden */
#park-screen { display:none; padding:20px; }
#player-info { display:flex; align-items:center; margin-bottom:10px; }
#player-avatar { font-size:48px; width:60px; height:60px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-right:10px; }
#avatar-custom button { margin:2px; padding:4px 6px; border:none; border-radius:6px; background:#ff6f61; color:white; }
#restaurants, #community, #garden-visual, #weekly-vote, #quest-reward, #ranking { margin:10px 0; padding:10px; border-radius:12px; background:rgba(255,255,255,0.95); box-shadow:0 3px 10px rgba(0,0,0,0.2); }
.menu-item, .post { display:flex; align-items:center; justify-content:space-between; margin:5px 0; }
.reward { margin:5px 0; padding:5px; background:#fff3b0; border-radius:6px; }
#garden-visual { position:relative; min-height:300px; background:#a0d0a0; overflow:hidden; }

/* Community */
#community-input input { width:80%; padding:6px; margin-right:4px; }
</style>
</head>
<body>

<!-- Welcome -->
<div id="welcome-screen">
  <h1>à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸šà¸™à¸±à¸à¸œà¸ˆà¸à¸ à¸±à¸¢!</h1>
  <h2>à¸„à¸¸à¸“à¸à¸£à¹‰à¸­à¸¡à¸­à¸­à¸à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¸à¸±à¸š YumYum Network à¸«à¸£à¸·à¸­à¸¢à¸±à¸‡? ğŸŒ³ğŸ”</h2>
  <button onclick="enterLogin()">à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¸œà¸ˆà¸à¸ à¸±à¸¢!</button>
</div>

<!-- Login / Avatar -->
<div id="login-screen">
  <h2>à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­à¸•à¸±à¸§à¸¥à¸°à¸„à¸£à¹à¸¥à¸°à¹€à¸¥à¸·à¸­à¸ Emoji Avatar</h2>
  <input type="text" id="player-name" placeholder="à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™..." maxlength="12">
  <div id="avatar-preview">ğŸ˜€</div>
  <div id="avatar-options">
    <span class="avatar-option" onclick="selectAvatar('ğŸ˜€')">ğŸ˜€</span>
    <span class="avatar-option" onclick="selectAvatar('ğŸ§™â€â™‚ï¸')">ğŸ§™â€â™‚ï¸</span>
    <span class="avatar-option" onclick="selectAvatar('ğŸ±')">ğŸ±</span>
    <span class="avatar-option" onclick="selectAvatar('ğŸ¶')">ğŸ¶</span>
    <span class="avatar-option" onclick="selectAvatar('ğŸ”')">ğŸ”</span>
    <span class="avatar-option" onclick="selectAvatar('ğŸ•')">ğŸ•</span>
  </div>
  <label>à¹€à¸¥à¸·à¸­à¸à¸ªà¸µà¸à¸·à¹‰à¸™à¸«à¸¥à¸±à¸‡:</label>
  <input type="color" id="player-bg" value="#ffffff">
  <button onclick="startAdventure()">à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆ YumYum Park!</button>
</div>

<!-- Park Screen -->
<div id="park-screen">
  <div id="player-info">
    <div id="player-avatar"></div>
    <div>
      <div id="player-name-display"></div>
      <div id="avatar-custom">
        <button onclick="changeHat()">à¸«à¸¡à¸§à¸ğŸ©</button>
        <button onclick="changeShirt()">à¹€à¸ªà¸·à¹‰à¸­ğŸ‘•</button>
        <button onclick="changeHair()">à¸—à¸£à¸‡à¸œà¸¡ğŸ’‡â€â™‚ï¸</button>
        <button onclick="changeFace()">à¸ªà¸µà¸«à¸™à¹‰à¸²ğŸ˜ƒ</button>
        <button onclick="changeFrame()">à¸à¸£à¸­à¸šğŸ“¸</button>
      </div>
    </div>
  </div>

  <!-- Restaurants -->
  <div id="restaurants"></div>

  <!-- Weekly Vote -->
  <div id="weekly-vote">
    <h3>à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œà¸«à¸™à¹‰à¸² ğŸ´</h3>
    <div id="vote-restaurants"></div>
    <div id="vote-result"></div>
  </div>

  <!-- Quest / Reward -->
  <div id="quest-reward">
    <h3>à¹€à¸„à¸§à¸ªà¸›à¸£à¸°à¸ˆà¸³à¸§à¸±à¸™ / à¸£à¸²à¸‡à¸§à¸±à¸¥</h3>
    <div id="quest-info"></div>
    <button onclick="completeQuest('à¸£à¸µà¸§à¸´à¸§')">à¸£à¸µà¸§à¸´à¸§à¸­à¸²à¸«à¸²à¸£ +10 à¹à¸•à¹‰à¸¡</button>
    <button onclick="completeQuest('à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™')">à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™ +10 à¹à¸•à¹‰à¸¡</button>
    <button onclick="completeQuest('à¹‚à¸à¸ªà¸•à¹Œ')">à¹‚à¸à¸ªà¸•à¹Œ +10 à¹à¸•à¹‰à¸¡</button>
    <button onclick="completeQuest('à¸­à¸§à¸²à¸•à¸²à¸£à¹Œ')">à¸•à¸à¹à¸•à¹ˆà¸‡ Avatar +10 à¹à¸•à¹‰à¸¡</button>
    <div id="reward-shop"></div>
  </div>

  <!-- Community -->
  <div id="community">
    <h3>à¸Šà¸¸à¸¡à¸Šà¸™ YumYum Park ğŸŒ</h3>
    <div id="posts"></div>
    <div id="community-input">
      <input type="text" id="post-text" placeholder="à¸à¸´à¸¡à¸à¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸«à¸£à¸·à¸­à¸£à¸µà¸§à¸´à¸§...">
      <button onclick="addPost()">à¹‚à¸à¸ªà¸•à¹Œ</button>
    </div>
  </div>

  <!-- Garden -->
  <div id="garden-visual">
    <h3>à¸ªà¸§à¸™ YumYum ğŸŒ³</h3>
  </div>

  <!-- Ranking -->
  <div id="ranking">
    <h3>Top Menu à¸‚à¸­à¸‡ YumYum Park</h3>
    <ul id="top-menu-list"></ul>
  </div>
</div>

<footer>Â© 2025 TasteLink - YumYum Network</footer>

<script>
// ---------------- Firebase ----------------
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ---------------- Welcome / Login ----------------
let playerEmoji='ğŸ˜€', playerBG='#ffffff', playerName='';
function enterLogin(){ document.getElementById('welcome-screen').style.display='none'; document.getElementById('login-screen').style.display='flex'; }
function selectAvatar(e){ playerEmoji=e; document.getElementById('avatar-preview').textContent=e; }
function startAdventure(){
  let name=document.getElementById('player-name').value;
  if(!name){ alert('à¸à¸£à¸¸à¸“à¸²à¹ƒà¸ªà¹ˆà¸Šà¸·à¹ˆà¸­!'); return; }
  playerName=name; playerBG=document.getElementById('player-bg').value;
  document.getElementById('login-screen').style.display='none';
  document.getElementById('park-screen').style.display='block';
  initPark();
  loadRealtimeData();
}

// ---------------- Park ----------------
let questPoints=0, badges={à¸£à¸µà¸§à¸´à¸§:false,à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™:false,à¹‚à¸à¸ªà¸•à¹Œ:false,à¸­à¸§à¸²à¸•à¸²à¸£à¹Œ:false};
let restaurantData=[
{name:'à¸£à¹‰à¸²à¸™ A',menu:[{name:'à¸‚à¹‰à¸²à¸§à¹„à¸‚à¹ˆà¹€à¸ˆà¸µà¸¢à¸§',stars:0},{name:'à¸ªà¸›à¸²à¹€à¸à¹‡à¸•à¸•à¸µà¹‰',stars:0},{name:'à¸ªà¸¥à¸±à¸”',stars:0}]},
{name:'à¸£à¹‰à¸²à¸™ B',menu:[{name:'à¸à¸´à¸‹à¸‹à¹ˆà¸²',stars:0},{name:'à¹€à¸šà¸­à¸£à¹Œà¹€à¸à¸­à¸£à¹Œ',stars:0},{name:'à¹€à¸Ÿà¸£à¸™à¸Šà¹Œà¸Ÿà¸£à¸²à¸¢',stars:0}]},
{name:'à¸£à¹‰à¸²à¸™ C',menu:[{name:'à¸‹à¸¹à¸Šà¸´',stars:0},{name:'à¸£à¸²à¹€à¸¡à¸‡',stars:0},{name:'à¸‚à¸™à¸¡à¸›à¸±à¸‡à¸›à¸´à¹‰à¸‡',stars:0}]},
{name:'à¸£à¹‰à¸²à¸™ D',menu:[{name:'à¸Šà¸²',stars:0},{name:'à¸à¸²à¹à¸Ÿ',stars:0},{name:'à¸ªà¸¡à¸¹à¸—à¸•à¸µà¹‰',stars:0}]},
{name:'à¸£à¹‰à¸²à¸™ E',menu:[{name:'à¹„à¸à¹ˆà¸—à¸­à¸”',stars:0},{name:'à¸à¸´à¸‹à¸‹à¹ˆà¸²',stars:0},{name:'à¹€à¸šà¸­à¸£à¹Œà¹€à¸à¸­à¸£à¹Œ',stars:0}]}
];
let votes={}; 

function initPark(){
  document.getElementById('player-name-display').textContent=playerName;
  document.getElementById('player-avatar').textContent=playerEmoji;
  document.getElementById('player-avatar').style.background=playerBG;
  renderRestaurants(); renderVoteOptions(); renderRewards(); renderRanking();
}

// ---------------- Restaurants ----------------
function renderRestaurants(){
  const container=document.getElementById('restaurants'); container.innerHTML='';
  restaurantData.forEach((r,i)=>{
    const div=document.createElement('div'); div.style.marginBottom='8px';
    div.innerHTML=`<h3>${r.name}</h3>`;
    r.menu.forEach((m,j)=>{
      const btnId=`btn-${i}-${j}`;
      div.innerHTML+=`<div class="menu-item">
        <span>${m.name} â­${m.stars}</span>
        <button onclick="addStar(${i},${j},'menu','${btnId}')">à¹‚à¸«à¸§à¸•à¹€à¸¡à¸™à¸¹</button>
      </div>`;
    });
    div.innerHTML+=`<button onclick="addStar(${i},-1,'restaurant')">à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™à¸™à¸µà¹‰</button>`;
    container.appendChild(div);
  });
}

function addStar(ri,mi,type,btnId){
  const key=(mi>=0)?`menu-${ri}`:`restaurant-${ri}`;
  if(votes[key]){ alert('à¸„à¸¸à¸“à¹‚à¸«à¸§à¸•à¹à¸¥à¹‰à¸§à¸ªà¸³à¸«à¸£à¸±à¸šà¸­à¸±à¸™à¸™à¸µà¹‰!'); return; }
  votes[key]=true;
  if(type==='menu') restaurantData[ri].menu[mi].stars+=1;
  completeQuest('à¹‚à¸«à¸§à¸•à¸£à¹‰à¸²à¸™');
  renderRestaurants();
  renderRanking();
  // Save to Firebase
  db.collection('votes').add({player:playerName,type:type,restaurant:ri,menu:mi,timestamp:Date.now()});
}

// ---------------- Quest / Reward ----------------
function completeQuest(type){
  if(!badges[type]){ badges[type]=true; alert(`Badge: ${type} ğŸ…`); }
  questPoints+=10;
  document.getElementById('quest-info').textContent=`à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š ${questPoints} à¹à¸•à¹‰à¸¡!`;
  renderRewards();
}

function renderRewards(){
  const shop=document.getElementById('reward-shop');
  const items=[{name:'à¹€à¸ªà¸·à¹‰à¸­à¸ªà¸µà¹à¸”à¸‡',cost:30},{name:'à¸«à¸¡à¸§à¸à¹à¸Ÿà¸™à¸‹à¸µ',cost:50},{name:'à¸—à¸£à¸‡à¸œà¸¡à¸à¸´à¹€à¸¨à¸©',cost:40},{name:'à¸à¸£à¸­à¸šà¸—à¸­à¸‡',cost:60}];
  shop.innerHTML='<h4>à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²à¹à¸¥à¸à¸‚à¸­à¸‡à¸£à¸²à¸‡à¸§à¸±à¸¥</h4>';
  items.forEach(it=>{ shop.innerHTML+=`<div class="reward">${it.name} - ${it.cost} à¹à¸•à¹‰à¸¡ <button onclick="buyReward('${it.name}',${it.cost})">à¹à¸¥à¸</button></div>`; });
}

function buyReward(name,cost){ if(questPoints>=cost){ questPoints-=cost; alert(`à¹à¸¥à¸ ${name} à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢!`); renderRewards(); }else alert('à¹à¸•à¹‰à¸¡à¹„à¸¡à¹ˆà¸à¸­!'); }

// ---------------- Community + Garden ----------------
function addPost(){
  const text=document.getElementById('post-text').value; if(!text) return;
  const newPost={name:playerName,emoji:playerEmoji,text:text,bg:playerBG,timestamp:Date.now()};
  db.collection('posts').add(newPost);
  document.getElementById('post-text').value='';
}

function loadRealtimeData(){
  // Community Realtime
  db.collection('posts').orderBy('timestamp','desc').onSnapshot(snapshot=>{
    const container=document.getElementById('posts'); container.innerHTML='';
    const garden=document.getElementById('garden-visual'); garden.innerHTML='<h3>à¸ªà¸§à¸™ YumYum ğŸŒ³</h3>';
    snapshot.forEach(doc=>{
      const p=doc.data();
      container.innerHTML+=`<div class="post">${p.emoji} ${p.name}: ${p.text}</div>`;
      addAvatarToGarden(p);
    });
  });
}

// Garden Avatar
function addAvatarToGarden(p){
  const garden=document.getElementById('garden-visual');
  const avatar=document.createElement('div');
  avatar.style.position='absolute'; avatar.style.left=Math.random()*80+'%'; avatar.style.top=Math.random()*60+'%';
  avatar.style.textAlign='center'; avatar.style.fontSize='32px';
  const av=document.createElement('div'); av.textContent=p.emoji; av.style.background=p.bg; av.style.borderRadius='50%';
  av.style.width='50px'; av.style.height='50px'; av.style.display='flex'; av.style.alignItems='center'; av.style.justifyContent='center'; avatar.appendChild(av);
  const bubble=document.createElement('div'); bubble.textContent=p.text; bubble.style.position='absolute'; bubble.style.top='-30px';
  bubble.style.left='50%'; bubble.style.transform='translateX(-50%)'; bubble.style.background='rgba(255,255,255,0.9)'; bubble.style.padding='2px 6px'; bubble.style.borderRadius='6px'; avatar.appendChild(bubble);
  garden.appendChild(avatar); setTimeout(()=>{avatar.remove();},15000);
}

// Weekly Vote
function renderVoteOptions(){
  const voteDiv=document.getElementById('vote-restaurants'); voteDiv.innerHTML='';
  restaurantData.forEach((r,i)=>{
    const btn=document.createElement('button'); btn.textContent=r.name; btn.onclick=()=>addStar(i,-1,'restaurant'); voteDiv.appendChild(btn);
  });
}

// Ranking
function renderRanking(){
  const list=document.getElementById('top-menu-list'); list.innerHTML='';
  let allMenus=[]; restaurantData.forEach(r=>r.menu.forEach(m=>allMenus.push({name:m.name,stars:m.stars})));
  allMenus.sort((a,b)=>b.stars-a.stars); allMenus.slice(0,5).forEach((m,i)=>{ list.innerHTML+=`<li>${i+1}. ${m.name} â­${m.stars}</li>`; });
}

// ---------------- Avatar Custom (placeholder functions) ----------------
function changeHat(){ alert('à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸«à¸¡à¸§à¸'); }
function changeShirt(){ alert('à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸ªà¸·à¹‰à¸­'); }
function changeHair(){ alert('à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸—à¸£à¸‡à¸œà¸¡'); }
function changeFace(){ alert('à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸µà¸«à¸™à¹‰à¸²'); }
function changeFrame(){ alert('à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸à¸£à¸­à¸š'); }

</script>
</body>
</html>
